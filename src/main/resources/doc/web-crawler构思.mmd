Mind Map generated by NB MindMap plugin   
> __version__=`1.1`
---

# Root
- NOTE
<pre>当前的需求：
    1. 监控某个网站的文章，并且当文章内容包含特定的关键字，那么就需要对HTML特定区域进行校验。 
    2. 资源如何被消耗的。成功一个，更新一个。增量模式。解析功能亦是如此。
    3.


应用的技术：
    1. 数据存储的依赖，mongodb
    2. 网络请求用， selenium


目标：
    1. 程序的耦合性一定要低。


大致流程：
    1. 初始化资源池
    2. 下载模块获取资源，下载网页
        * 
    3. 
</pre>

## 数据采集模块\(重点\)
- NOTE
<pre>1. 因为定时监测的，建议爬虫是定时创建，作用域只在当前任务期间有效。

理念：
    1. 爬虫的生命周期在当前任务，但是数据采集是否需要参考历史数据呢？</pre>

### 下载模块
> mmd.emoticon=`accept_button`,topicLinkUID=`166000C1940A`

- NOTE
<pre>负责发送请求下载网页

这个可以编写通用模块，子类也可以自己实现具体的请求方式。

-- 简单流程
入参：资源主体
1. 请求数据
2. 校验是否请求成功，检验原则，检验自己知道情况，非自己知道的情况，当作校验失败来处理。
    * HTTP响应校验 200。
    * 网页特征校验，是否满足观察到的特征。
 3. 可能还在当前网页中提取链接，建议将链接获取到，然后与HTML一起返回到上游，一起存储。
    * 建议以Map形式返回，规定标识。
    * HTML与提取链接的关系，HTML肯定有，但是链接可以为空。所以上游条件的判断，判断HTML是否有效，来决定当前链接是否成功获取到了资源，如果未成功获取将认为失败。1. 存储HTML；2. 判断是否有链接存储，有的话，就存储，没有就跳过。

返回结果：Map&lt;String, Object&gt;集合。集合中包含的key [ResponseResultService, URLS]。如果结果为空则当前请求失败，否则成功。

-- 具体的功能
1. 是否启用代理的标识；
2. 日志记录；
3. 需要一个mongdb的DAO，需要将日志记录，记录到数据库中。这个是否必要待考量？（TODO）
4. 驱动器的地址及其驱动的日志路径；
5. 代理的切换策略；
</pre>

### 解析模块
> topicLinkUID=`166000D4493A`

- NOTE
<pre>解析HTML文件
这个每个爬虫单独实现</pre>

### 资源池模块
> mmd.emoticon=`accept_button`,topicLinkUID=`166000B5B89A`

- NOTE
<pre>资源地址管理模块

1.  判断资源是否有效的，标识位IS_ENABLE（有效-1，无效-0）.
2. 资源主体包含的属性
    * CREATE_TIME - 创建时间
    * IS_ENABLE - 标识资源是否有效
    * URL - 资源
    * TREE - 深度，由数字组成，从0往后，数值越大深度越深
    * REMARK - 备注
3. 重点包含三大功能
    * 资源的获取
    * 资源的更新
    * 资源的存储</pre>
- TOPIC
<pre>166004B08D2A</pre>

### 数据存储模块
- NOTE
<pre>1. 数据存储将与Python版本有所差异，只存储在一个数据库中。
2. 表有，URL\ResponseResultService\DATA\History
    URL - 存储URL
    ResponseResultService - 存储下载下来的界面
    DATA - 解析后的数据
    History - 历史数据
3. 通过标识位去区别
4. 每个爬虫，都需要在存储的时候附加一些参数</pre>

#### 响应结果存储模块
> mmd.emoticon=`accept_button`

- NOTE
<pre>ResponseResultServiceImpl实现  </pre>

### 历史数据对比模块

### 流程控制模块
- NOTE
<pre>纠结的地方：
1. 是边下载便解析呢？还是下载完毕再解析？
    * 个人认为还是等全部下载完毕之后再解析

1. 资源（URL）初始化
2. foreach 资源池（资源池什么时候算空，IS_ENABLE == 0）
3. 网页下载，下载成功进行下一步
    * 是否下载成功，需要规范出一定的规约
4. 网页解析，解析成功进行下一步
    * 是否解析成功，需要规范出一定的规约
</pre>

#### 1\. 资源初始化
- NOTE
<pre>由【资源池模块】进行管理</pre>
- TOPIC
<pre>166000B5B89A</pre>

#### 2\. 网页下载
- NOTE
<pre>调用【下载模块】        </pre>
- TOPIC
<pre>166000C1940A</pre>

#### 3\.网页解析
- NOTE
<pre>由【解析模块】实现</pre>
- TOPIC
<pre>166000D4493A</pre>

### 消息通知模块
- NOTE
<pre>主要功能： 发送通知，谁想要发送通知，谁自行调用

1.异常捕获通知
2.发现新数据进行捕获</pre>

## 数据可视化模块

### 数据统计模块
> collapsed=`true`,topicLinkUID=`166000F45A4A`

- NOTE
<pre>需要列出统计方式，具体看需求，让领导看起来爽（直观）：
1. 待考虑</pre>

### 前端展示模块
> leftSide=`true`

- NOTE
<pre>由【数据统计模块】提供数据，故此需要与【数据统计模块】达成一定规约，按照一定的规约传输数据。数据格式尽可能不需要【前端展示模块】处理，直接进行展示。</pre>
- TOPIC
<pre>166000F45A4A</pre>

## 主体
> leftSide=`true`


### 资源主体
> topicLinkUID=`166004B08D2A`

- NOTE
<pre>包含的属性，后续补充：
    * CREATE_TIME - 创建时间
    * IS_ENABLE - 标识资源是否有效。0-无效或已被使用，1-有效或未被使用，2-当前任务阶段重复使用达到上限。
    * URL - 资源。
    * TREE - 深度，由数字组成，从0往后，数值越大深度越深。
    * REMARK - 备注。
    * REUSE_NUM - 重复使用次数，当重复使用的次数达到上限的时候，该资源废弃，将IS_ENABLE设置为2.</pre>

### 下载内容主体
> leftSide=`true`

- NOTE
<pre>包含属性
    * URL - 资源主体
    * HTML - 下载的内容
    * IS_ENABLE - 是否有效

关于IS_ENABLE的说明
1. 响应结果，isEnable状态位说明 &lt;br&gt;
 * 1.1 需要不进行解析的isEnable = 2 &lt;br&gt;
 * 1.2 需要进行解析的isEnable = 1 &lt;br&gt;
 * 1.3 解析成功的isEnable = 0 &lt;br&gt;
 * 1.4 解析失败不做更新，会反复被解析，这里需要通知下，再议。 &lt;br&gt;</pre>

## 组件
> leftSide=`true`


### 资源池组件

### 数据存储组件
> leftSide=`true`

